(function(a,y){var c=a.className("left");var b=a.className("center");var j=a.className("right");var f=a.className("page");var h=a.className("page-left");var g=a.className("page-center");var e=a.className("navbar-left");var d=a.className("navbar-center");var i=a.className("page-shadow");var k=a.className("transitioning");var o="."+c;var m="."+b;var w="."+j;var n=a.classSelector(".icon");var p=a.classSelector(".navbar");var r=a.classSelector(".navbar-inner");var v=a.classSelector(".pages");var l=a.classSelector(".btn-nav");var u="."+h;var t="."+g;var s="."+e;var q="."+d;var x=a.Class.extend({init:function(z,A){this.view=this.element=z;this.options=a.extend({animateNavbar:"ios",swipeBackPageActiveArea:30,hardwareAccelerated:true},A);this.navbars=this.view.querySelector(p);this.pages=this.view.querySelector(v);this.history=[];this.maxScrollX=this.view.offsetWidth;this.x=this.y=0;this.translateZ=this.options.hardwareAccelerated?" translateZ(0)":"";this.ratio=0;this.isBack=true;this.moved=this.dragging=false;this.activeNavbar=this.previousNavbar=null;this.activePage=this.previousPage=null;this._initPageEventMethod();this._initDefaultPage();this.navbars&&this._initNavBar();this.initEvent()},_initPageEventMethod:function(){var z=this;a.each(["onPageBeforeShow","onPageShow","onPageBeforeBack","onPageBack"],function(B,A){z[A+"Callbacks"]={};z[A]=function(E,C){var D=A+"Callbacks";if(!z[D].hasOwnProperty(E)){z[D][E]=[C]}else{z[D][E].push(C)}}})},_initDefaultPage:function(){var z=document.querySelector(this.options.defaultPage);if(z){this._appendPage(z)}else{throw new Error("defaultPage["+this.options.defaultPage+"] does not exist")}},initEvent:function(){this.view.addEventListener("click",this);this.view.addEventListener("tap",this);this.pages.addEventListener("drag",this);this.pages.addEventListener("dragend",this);this.pages.addEventListener("webkitTransitionEnd",this)},handleEvent:function(z){switch(z.type){case"click":this._click(z);break;case"tap":this._tap(z);break;case"drag":this._drag(z);break;case"dragend":this._dragend(z);break;case"webkitTransitionEnd":this._webkitTransitionEnd(z);break}},shadow:function(){var z=document.createElement("div");z.className=i;return z}(),_removePage:function(A,z){z&&this._removeNavbar(A,z);document.body.appendChild(A);this._cleanPageClass(A)},_prependPage:function(A){var z=A.querySelector(r);z&&this._prependNavbar(z);A.classList.add(h);this.pages.insertBefore(A,this.pages.firstElementChild)},_appendPage:function(A){var z=A.querySelector(r);z&&this._appendNavbar(z);A.classList.add(g);this.pages.appendChild(A)},_removeNavbar:function(A,z){A.insertBefore(z,A.firstElementChild);this._cleanNavbarClass(z)},_prependNavbar:function(z){z.classList.add(e);this.navbars.insertBefore(z,this.navbars.firstElementChild)},_appendNavbar:function(z){z.classList.add(d);this.navbars.appendChild(z)},_cleanPageClass:function(z){z.classList.remove(g);z.classList.remove(h)},_cleanNavbarClass:function(z){z.classList.remove(d);z.classList.remove(e)},_tap:function(z){var B=z.target;for(;B&&B!==document;B=B.parentNode){if(B.tagName==="A"&&B.hash){var A=document.getElementById(B.hash.replace("#",""));if(A&&A.classList.contains(f)){z.stopPropagation();z.detail.gesture.preventDefault();this.go(B.hash);break}}}},_click:function(z){var B=z.target;for(;B&&B!==document;B=B.parentNode){if(B.tagName==="A"&&B.hash){var A=document.getElementById(B.hash.replace("#",""));if(A&&A.classList.contains(f)){z.preventDefault();break}}}},_cleanStyle:function(z){if(z){z.style.webkitTransform="";z.style.opacity=""}},_isAnimateNavbarIOS:function(){return a.os.ios&&this.options.animateNavbar==="ios"},_webkitTransitionEnd:function(z){this.dragging=this.moved=false;if(this.activePage!==z.target){return}this.isInTransition=false;this.shadow.parentNode===this.activePage&&this.activePage.removeChild(this.shadow);this.previousPageClassList.remove(k);this.activePageClassList.remove(k);var B=this;if(this._isAnimateNavbarIOS()&&this.previousNavElements&&this.activeNavElements){var A=this.isBack;a.each(this.previousNavElements,function(D,C){C.classList.remove(k);A&&B._cleanStyle(C)});a.each(this.activeNavElements,function(D,C){C.classList.remove(k);B._cleanStyle(C)});if(this.previousNavBackIcon){this.previousNavBackIcon.classList.remove(k);A&&this._cleanStyle(this.previousNavBackIcon)}if(this.activeNavBackIcon){this.activeNavBackIcon.classList.remove(k);this._cleanStyle(this.activeNavBackIcon)}}else{this.previousNavbar&&this.previousNavbar.classList.remove(k);this.activeNavbar&&this.activeNavbar.classList.remove(k);this._cleanStyle(this.previousNavbar);this._cleanStyle(this.activeNavbar)}this._cleanStyle(this.previousPage);this._cleanStyle(this.activePage);if(this.ratio<=0.5){return}if(this.isBack){this._removePage(this.activePage,this.activeNavbar);this.previousPageClassList.remove(h);this.previousPageClassList.add(g);if(this.previousNavbar){this.previousNavbar.classList.remove(e);this.previousNavbar.classList.add(d)}if(this.history.length>0){this._prependPage(this.history.pop())}this.navbars&&this._initNavBar();this._trigger("pageBack",this.activePage);this._trigger("pageShow",this.previousPage)}else{this.previousPageClassList.add(h);this.activePageClassList.add(g);this._trigger("pageShow",this.activePage)}},_trigger:function(C,E){var B="on"+C.charAt(0).toUpperCase()+C.slice(1)+"Callbacks";if(this[B].hasOwnProperty(E.id)){var z=this[B][E.id];var A=new CustomEvent(C,{detail:{page:E},bubbles:true,cancelable:true});for(var D=z.length;D--;){z[D].apply(this,A)}}a.trigger(this.view,C,{page:E})},_initPageTransform:function(){this.previousPage=this.pages.querySelector(u);this.activePage=this.pages.querySelector(t);if(this.previousPage&&this.activePage){this.activePage.appendChild(this.shadow);this.previousPageClassList=this.previousPage.classList;this.activePageClassList=this.activePage.classList;this.previousPageStyle=this.previousPage.style;this.activePageStyle=this.activePage.style;this.previousPageClassList.remove(k);this.activePageClassList.remove(k);if(this.navbars){this.previousNavbar=this.navbars.querySelector(s);this.activeNavbar=this.navbars.querySelector(q);if(this._isAnimateNavbarIOS()&&this.previousNavbar&&this.activeNavbar){this.previousNavElements=this.previousNavbar.querySelectorAll(o+","+m+","+w);this.activeNavElements=this.activeNavbar.querySelectorAll(o+","+m+","+w);this.previousNavBackIcon=this.previousNavbar.querySelector(o+l+" "+n);this.activeNavBackIcon=this.activeNavbar.querySelector(o+l+" "+n)}}this.x=0;this.dragging=true;return true}return false},_initNavBar:function(){if(this._isAnimateNavbarIOS()&&this.navbars){var G=this.navbars.querySelectorAll(r);var F,H,O,z,I,P,B,L,M,C,D,K;for(var E=0,J=G.length;E<J;E++){F=G[E];H=F.querySelector(o);O=F.querySelector(w);z=F.querySelector(m);L=!H;noRight=!O;I=L?0:H.offsetWidth;P=noRight?0:O.offsetWidth;B=z?z.offsetWidth:0;K=this.maxScrollX;onLeft=F.classList.contains("navbar-left");if(noRight){C=K-B}if(L){C=0}if(!L&&!noRight){C=(K-P-B+I)/2}var N=(K-B)/2;if(K-I-P>B){if(N<I){N=I}if(N+B>K-P){N=K-P-B}D=N-C}else{D=0}var A=D;if(z){z.style.marginLeft=-I+"px";z.mNavbarLeftOffset=-(C+D)+30;z.mNavbarRightOffset=K-C-D-B}if(onLeft){z.style.webkitTransform=("translate3d("+z.mNavbarLeftOffset+"px, 0, 0)")}if(!L){H.mNavbarLeftOffset=-I;H.mNavbarRightOffset=(K-I)/2;if(onLeft){H.style.webkitTransform=("translate3d("+H[0].mNavbarLeftOffset+"px, 0, 0)")}}if(!noRight){O.mNavbarLeftOffset=-(K-P)/2;O.mNavbarRightOffset=P;if(onLeft){O.style.webkitTransform=("translate3d("+O[0].mNavbarLeftOffset+"px, 0, 0)")}}}}},_drag:function(B){if(this.isInTransition){return}var A=B.detail;if(!this.dragging){if((a.gestures.session.firstTouch.center.x-this.view.offsetLeft)<this.options.swipeBackPageActiveArea){this.isBack=true;this._initPageTransform()}}if(this.dragging){var z=0;if(!this.moved){z=A.deltaX;a.gestures.session.lockDirection=true;a.gestures.session.startDirection=A.direction}else{z=A.deltaX-(a.gestures.session.prevTouch&&a.gestures.session.prevTouch.deltaX||0)}var C=this.x+z;if(C<0||C>this.maxScrollX){C=C<0?0:this.maxScrollX}B.stopPropagation();A.gesture.preventDefault();if(!this.requestAnimationFrame){this._updateTranslate()}this.moved=true;this.x=C;this.y=0}},_dragend:function(A){if(!this.moved){return}A.stopPropagation();var z=A.detail;this._clearRequestAnimationFrame();this._prepareTransition();this.ratio=this.x/this.maxScrollX;if(this.ratio===1||this.ratio===0){a.trigger(this.activePage,"webkitTransitionEnd");return}if(this.ratio>0.5){this.setTranslate(this.maxScrollX,0)}else{this._cleanStyle(this.previousPage);this._cleanStyle(this.activePage)}},_prepareTransition:function(){this.isInTransition=true;this.previousPageClassList.add(k);this.activePageClassList.add(k);var z=this;if(this.previousNavbar&&this.activeNavbar){this.previousNavbar.classList.add(k);this.activeNavbar.classList.add(k);if(this._isAnimateNavbarIOS()&&this.previousNavElements&&this.activeNavElements){a.each(this.previousNavElements,function(B,A){A.classList.add(k);z._cleanStyle(A)});a.each(this.activeNavElements,function(B,A){A.classList.add(k);z._cleanStyle(A)});if(this.previousNavBackIcon){this._cleanStyle(this.previousNavBackIcon);this.previousNavBackIcon.classList.add(k)}if(this.activeNavBackIcon){this._cleanStyle(this.activeNavBackIcon);this.activeNavBackIcon.classList.add(k)}}}},_clearRequestAnimationFrame:function(){if(this.requestAnimationFrame){cancelAnimationFrame(this.requestAnimationFrame);this.requestAnimationFrame=null}},_getTranslateStr:function(z,A){if(this.options.hardwareAccelerated){return"translate3d("+z+"px,"+A+"px,0px) "+this.translateZ}return"translate("+z+"px,"+A+"px) "},_updateTranslate:function(){var z=this;if(z.x!==z.lastX||z.y!==z.lastY){z.setTranslate(z.x,z.y)}z.requestAnimationFrame=requestAnimationFrame(function(){z._updateTranslate()})},_setNavbarTranslate:function(A,B){var z=A/this.maxScrollX;if(this._isAnimateNavbarIOS()){if(this.previousNavElements&&this.activeNavElements){this.animateNavbarByIOS(z)}}else{this.activeNavbar.style.opacity=1-z*1.3;this.previousNavbar.style.opacity=z*1.3-0.3}},animateNavbarByIOS:function(D){var B,C,F,A;for(B=0,C=this.activeNavElements.length;B<C;B++){A=this.activeNavElements[B];F=A.style;F.opacity=(1-D*(A.classList.contains(c)?3.5:1.3));if(!A.classList.contains(j)){var z=D*A.mNavbarRightOffset;A.style.webkitTransform=("translate3d("+z+"px,0,0)");if(A.classList.contains(c)&&this.activeNavBackIcon){this.activeNavBackIcon.style.webkitTransform=("translate3d("+-z+"px,0,0)")}}}for(B=0,C=this.previousNavElements.length;B<C;B++){A=this.previousNavElements[B];F=A.style;F.opacity=D*1.3-0.3;if(!A.classList.contains(j)){var E=A.mNavbarLeftOffset*(1-D);A.style.webkitTransform=("translate3d("+E+"px,0,0)");if(A.classList.contains(c)&&this.previousNavBackIcon){this.previousNavBackIcon.style.webkitTransform=("translate3d("+-E+"px,0,0)")}}}},setTranslate:function(z,A){this.x=z;this.y=A;this.previousPage.style.opacity=0.9+0.1*z/this.maxScrollX;this.previousPage.style.webkitTransform=this._getTranslateStr((z/6-this.maxScrollX/6),A);this.activePage.style.webkitTransform=this._getTranslateStr(z,A);this.navbars&&this._setNavbarTranslate(z,A);this.lastX=this.x;this.lastY=this.y},canBack:function(){return this.pages.querySelector(u)},back:function(){if(this.isInTransition){return}this.isBack=true;this.ratio=1;if(this._initPageTransform()){this._trigger("pageBeforeBack",this.activePage);this._trigger("pageBeforeShow",this.previousPage);this._prepareTransition();this.previousPage.offsetHeight;this.activePage.offsetHeight;this.setTranslate(this.maxScrollX,0)}},go:function(C){if(this.isInTransition){return}var B=document.querySelector(C);if(B){var E=this.pages.querySelector(u);var A=this.pages.querySelector(t);var D;var z;if(this.navbars){D=this.navbars.querySelector(s);z=this.navbars.querySelector(q)}if(z){z.classList.remove(d);z.classList.add(e)}if(E){this._removePage(E,D);this.history.push(E)}if(A){A.classList.remove(g);A.style.webkitTransform="translate3d(0,0,0)";A.classList.add(h)}B.style.webkitTransform="translate3d(100%,0,0)";this._appendPage(B);B.appendChild(this.shadow);B.offsetHeight;this.isBack=false;this.ratio=1;this._initPageTransform();this.navbars&&this._initNavBar();this.navbars&&this._setNavbarTranslate(this.maxScrollX,0);this.previousPage.offsetHeight;this.activePage.offsetHeight;if(this.navbars){this.previousNavbar.offsetHeight;this.activeNavbar.offsetHeight}this._trigger("pageBeforeShow",this.activePage);this._prepareTransition();this.setTranslate(0,0)}}});a.fn.view=function(A){var B=this[0];var C=null;var z=B.getAttribute("data-view");if(!z){z=++a.uuid;a.data[z]=C=new x(B,A);B.setAttribute("data-view",z)}else{C=a.data[z]}return C}})(mui,window);